---
title: 'Лабораториска вежба бр.3: Дескриптивни статистики, Метод на моменти и Параметарски
  тестови'
output:
  html_document:
    df_print: paged
  pdf_document: default
editor_options: null
chunk_output_type: inline
---

### Опис

Во оваа лабораториска вежба ќе се запознаеме со дескриптивните статистики кои можеме да ги направиме на одреден примерок од популацијата, метод на моменти како начин на проценка на параметрите на дадена веројатносна распределба и параметарските тестови.

### **1. Дескриптивни статистики**

**Математичката статистика** е научна дисциплина која се занимава со собирање, анализирање, претставување, интерпретација на податоци, и донесување на научно засновани заклучоци.

**Статистички податоци** се информации или карактеристики што се собираат преку набљудување, мерење или проучување на група од слични објекти или појави. Статистичките податоци служат за анализа и донесување заклучоци во различни области.

На пример ако ги проучуваме домаќинствата во градот Скопје, статистичките податоци може да опфаќаат:

-   бројот на членови кои живеаат во домаќинството,
-   просечниот месечен приход,
-   типот на живеалиште (стан, куќа или друг вид на живеалиште),
-   потрошувачката на електрична енергија,
-   бројот на автомобили кои домаќинството ги поседува,
-   присуство на домашни миленици,
-   типот на користени извори на греење.

### Популација и обележје

Во статистиката, множеството еднородни објекти или резултати од некоја операција, кои имаат една или повеќе заеднички карактеристики се нарекува **популација**.

Заедничката карактеристика се нарекува **обележје**.

Во примерот со домаќинства популација се сите домаќинства во градот Скопје, додека пак обележјата се: бројот на членови во домаќинството, месечниот приход, типот на живеалиште (куќа, стан), бројот на автомобили, користените извори на енергија за греење и присуството на домашни миленици.

Популацијата е основен поим во статистиката и тој не се дефинира експлицитно.

Популацијата се означува со **Ω**, бидејќи тоа е множеството од сите можни исходи во врска со еден експеримент (множеството на елементарни настани).

------------------------------------------------------------------------

### Видови на податоци

Постојат два вида на податоци:

1.  **Нумерички податоци:**
    -   Податоци изразени во броеви, кои се добиваат преку **мерења** (времетраење на телефоснки повици во минути, пулс на срцето или пак време потребно за завршување на маратонот измерено во часови, минути или секунди) или **броење** (број на членови во едно домаќинство, број на победи на фудбалскиот тим Real Madrid во една сезона, број на производи продадени во еден маркет за еден ден). Овие податоци се нарекуваат и **квантитативни податоци**.\
    -   Нумеричките податоци можат да бидат:
        -   **Дискретни:** Податоци добиени со броење (на пример, бројот на деца во семејство).\
        -   **Непрекинати:** Податоци добиени со мерења (на пример, потрошувачка на електрична енергија).
2.  **Категориски податоци:**
    -   Податоци кои претставуваат карактеристики или категории (пол, националност, боја на очи). Тие може да имаат нумерички ознаки, но бројките немаат математичко значење. Познати се и како **квалитативни податоци**.\
    -   Категориските податоци можат да бидат:
        -   **Номинални:** Податоци без редослед, користени за обележување (на пример, пол, религија, место на раѓање).\
        -   **Ординални:** Податоци со редослед, кои дозволуваат рангирање (на пример, ниво на среќа, оценка на продуктивност).

### Примерок

-   Делот од популацијата на кој се вршат потребните испитувања се нарекува **примерок**.\
-   **Обем на примерокот:** бројот на елементи во примерокот.


### **1. Просек или аритметичка средина**

Просекот (или аритметичката средина) на примерокот се дефинира со следната формула:

$$
\bar{X} = \frac{1}{n} \sum_{i=1}^{n} X_i
$$ каде: - $n$ е големината на примерокот, - $X_i$ се индивидуалните вредности од примерокот.

**Пример за пресметка на просек во R:**
```{r}
# Податоци за температурата во Скопје за секој ден во месец Април
temperatures <- c(18, 20, 22, 19, 21, 20, 23, 24, 19, 18, 20, 22, 21, 23, 24, 25, 21, 20, 22, 23, 24, 26, 25, 22, 23, 24, 21, 20, 22, 23)

# Пресметување на просечната температура во Скопје за месец Април
average_temperature <- mean(temperatures)
print(average_temperature)
```

### **2. Дисперзија**

Дисперзијата на примерокот се дефинира со следната формула:

 $$
s^2 = \frac{1}{n-1} \sum_{i=1}^{n} (X_i - \bar{X})^2
$$ каде: - $n$ е големината на примерокот, - $X_i$ се индивидуалните вредности, - $\bar{X}$ е аритметичката средина.

**Пример за пресметка на дисперзија во R:**

```{r}
# Податоци за температурата во Скопје за секој ден во месец Април
temperatures <- c(18, 20, 22, 19, 21, 20, 23, 24, 19, 18, 20, 22, 21, 23, 24, 25, 21, 20, 22, 23, 24, 26, 25, 22, 23, 24, 21, 20, 22, 23)

# Пресметување на дисперзијата
variance_temperature <- var(temperatures)
print(variance_temperature)
```

### **3. Стандардна девијација**

Стандардната девијација се пресметува со следната формула:
 $$
s = \sqrt{s^2}
$$ каде: - $s^2$ е дисперзијата.

**Пример за пресметка на стандардна девијација во R:**
```{r}
# Податоци за температурата во Скопје за секој ден во месец Април
temperatures <- c(18, 20, 22, 19, 21, 20, 23, 24, 19, 18, 20, 22, 21, 23, 24, 25, 21, 20, 22, 23, 24, 26, 25, 22, 23, 24, 21, 20, 22, 23)

# Пресметување на стандардната девијација
std_dev_temperature <- sd(temperatures)
print(std_dev_temperature)
```

### **4. Медијана**

Медијана M на примерокот е бројот што
стои на средина на подредениот примерок. Точно 50% од
податоците во подредениот примерок се помали од него и
50% од податоците се поголеми од него. Медијаната се
дефинира со следната формула:

 $$
\text{Медијана} =
\begin{cases}
X_{(n+1)/2}, & \text{ако } n \text{ е непарен} \\
\frac{X_{n/2} + X_{n/2+1}}{2}, & \text{ако } n \text{ е парен}
\end{cases}
$$

**Пример за пресметка на медијана во R:**
```{r}
# Податоци за температурата во Скопје за секој ден во месец Април
temperatures <- c(18, 20, 22, 19, 21, 20, 23, 24, 19, 18, 20, 22, 21, 23, 24, 25, 21, 20, 22, 23, 24, 26, 25, 22, 23, 24, 21, 20, 22, 23)

# Пресметување на медијаната
median_temperature <- median(temperatures)
print(median_temperature)
```

Кога се пресметува медијана на подредениот примерок вредностите на обележјето од примерокот треба да бидат 
подредени во **неопаѓачки редослед**.

### **5. Прв и трет квартил**

Квартилите ја делат распределбата на податоците на четири еднакви делови. 

Првиот квартил ($Q1$) е 25-тиот перцентил, што значи дека 25% од податоците се помали од $Q1$. 

Третиот квартил ($Q3$) е 75-тиот перцентил, што значи дека 75% од податоците се помали од $Q3$.

Овие квартилни вредности се користат за разбирање на распространетоста на податоците.

**Пример за пресметка на првиот и третиот квартил во R:**
```{r}
# Податоци за температурата во Скопје за секој ден во месец Април
temperatures <- c(18, 20, 22, 19, 21, 20, 23, 24, 19, 18, 20, 22, 21, 23, 24, 25, 21, 20, 22, 23, 24, 26, 25, 22, 23, 24, 21, 20, 22, 23)

# Пресметување на првиот и третиот квартил
quartiles <- quantile(temperatures, probs = c(0.25, 0.75))
print(quartiles)
```

### **Интерквартално растојание (IQR)**

Интеркварталното растојание ($IQR$) е разлика помеѓу третиот ($Q3$) и првиот квартил ($Q1$). Оваа мерка ги опфаќа средните 50% од податоците, со што ја претставува нивната распространетост.

**Формула за пресметка на интеркварталното растојание ($IQR$) е следната:** $$
IQR = Q3 - Q1
$$ каде:

- $Q1$ е првиот квартил (25% од податоците се помали од оваа вредност)

- $Q3$ е третиот квартил (75% од податоците се помали од оваа вредност).

**Пример во R:**

```{r}
# Податоци за температурата во Скопје за секој ден во месец Април
temperatures <- c(18, 20, 22, 19, 21, 20, 23, 24, 19, 18, 20, 22, 21, 23, 24, 25, 21, 20, 22, 23, 24, 26, 25, 22, 23, 24, 21, 20, 22, 23)

# Пресметување на првиот и третиот квартил
quartiles <- quantile(temperatures, probs = c(0.25, 0.75))
q1 <- quartiles[1]
q3 <- quartiles[2]

# Пресметување на интеркварталното растојание
iqr_value <- IQR(temperatures)

# Резултати
print(q1)  # Прв квартил
print(q3)  # Трет квартил
print(iqr_value)  # Интерквартално растојание
```

### **Задача 1**

Група истражувачи спровеле истражување за да го следат движењето на диви животни (волци, елени и мечки) во еден национален парк. Со помош на GPS-тракери, се собирале податоци за растојанијата што овие животни ги поминале секој ден во период од 30 дена.
Пресметај ги дескриптивните статистики за движењето на секое диво животно посебно.

Волци (растојание во км): 8.2, 9.5, 10.0, 7.8, 8.9, 9.1, 10.5, 11.2, 8.4, 9.0, 7.5, 8.7, 9.6, 10.2, 11.5, 8.3, 9.8, 7.9, 10.1, 9.4, 8.6, 10.0, 8.5, 9.2, 7.7, 8.8, 10.3, 11.0, 9.7, 8.9. 

Елени (растојание во км): 12.5, 13.8, 14.0, 12.2, 13.0, 14.2, 13.5, 15.0, 14.8, 13.9, 12.7, 13.2, 14.0, 14.5, 15.2, 13.6, 14.3, 12.8, 14.6, 13.5, 13.1, 14.8, 13.4, 14.0, 13.7, 12.9, 14.4, 15.0, 13.8, 14.1. 

Мечки (растојание во км): 5.1, 4.8, 5.3, 4.5, 5.0, 4.7, 5.2, 5.5, 4.9, 5.1, 4.6, 4.8, 5.0, 5.4, 5.6, 4.7, 5.3, 4.5, 5.2, 5.0, 4.8, 5.3, 4.9, 5.1, 4.6, 4.7, 5.0, 5.4, 5.5, 4.9.

```{r}
#Изврши го твојот код тука
volci<-c(8.2, 9.5, 10.0, 7.8, 8.9, 9.1, 10.5, 11.2, 8.4, 9.0, 7.5, 8.7, 9.6, 10.2, 11.5, 8.3, 9.8, 7.9, 10.1, 9.4, 8.6, 10.0, 8.5, 9.2, 7.7, 8.8, 10.3, 11.0, 9.7, 8.9)
eleni<-c(12.5, 13.8, 14.0, 12.2, 13.0, 14.2, 13.5, 15.0, 14.8, 13.9, 12.7, 13.2, 14.0, 14.5, 15.2, 13.6, 14.3, 12.8, 14.6, 13.5, 13.1, 14.8, 13.4, 14.0, 13.7, 12.9, 14.4, 15.0, 13.8, 14.1)
mecki<-c(5.1, 4.8, 5.3, 4.5, 5.0, 4.7, 5.2, 5.5, 4.9, 5.1, 4.6, 4.8, 5.0, 5.4, 5.6, 4.7, 5.3, 4.5, 5.2, 5.0, 4.8, 5.3, 4.9, 5.1, 4.6, 4.7, 5.0, 5.4, 5.5, 4.9)
volci_prosek<-mean(volci)
volci_disperzija<-var(volci)
volci_sdev<-sd(volci)
volci_medijana<-median(volci)
volci_q1q3<-quantile(volci,probs=c(0.25,0.75))
volci_iqr<-IQR(volci)
cat("Prosek volci: ")
print(volci_prosek)
cat("Disperzij volci: ")
print(volci_disperzija)
cat("StDev volci: ")
print(volci_sdev)
cat("Medij volci: ")
print(volci_medijana)
cat("Q1 Q3 volci: ")
print(volci_q1q3)
cat("IQR volci: ")
print(volci_iqr)
cat("__________________________")
eleni_prosek<-mean(eleni)
eleni_disperzija<-var(eleni)
eleni_sdev<-sd(eleni)
eleni_medijana<-median(eleni)
eleni_q1q3<-quantile(eleni,probs=c(0.25,0.75))
eleni_iqr<-IQR(eleni)
cat("Prosek eleni: ")
print(eleni_prosek)
cat("Disperzij eleni: ")
print(eleni_disperzija)
cat("StDev veleni: ")
print(eleni_sdev)
cat("Medij eleni: ")
print(eleni_medijana)
cat("Q1 Q3 eleni: ")
print(eleni_q1q3)
cat("IQR eleni: ")
print(eleni_iqr)
cat("__________________________")
mecki_prosek<-mean(mecki)
mecki_disperzija<-var(mecki)
mecki_sdev<-sd(mecki)
mecki_medijana<-median(mecki)
mecki_q1q3<-quantile(mecki,probs=c(0.25,0.75))
mecki_iqr<-IQR(mecki)
cat("Prosek mecki: ")
print(mecki_prosek)
cat("Disperzij mecki: ")
print(mecki_disperzija)
cat("StDev mecki: ")
print(mecki_sdev)
cat("Medij mecki: ")
print(mecki_medijana)
cat("Q1 Q3 mecki: ")
print(mecki_q1q3)
cat("IQR mecki: ")
print(mecki_iqr)

```

### **2. Метод на моменти**
Методот на моменти е метод за определување на точкасти оценувачи.

**Опис на алгоритмот на метод на моменти**

Нека \( (X_1, X_2, \dots, X_n) \) е случаен примерок за обележје со закон или густина на распределба кои зависат од \( m \) непознати параметри \( \theta_1, \theta_2, \dots, \theta_m \). 

**Алгоритмот за определување на точкасти оценувачи на параметрите со методот на моменти се состои од следниве чекори:**

 **Чекор 1**
Изедначи ги првите \( m \) моменти на примерокот со првите \( m \) моменти на обележјето \( X \).

 **Чекор 2**
Реши ги добиените равенки од Чекор 1 по непознатите параметри \( \theta_1, \theta_2, \dots, \theta_m \).

 **Решение**
Решенијата на овие равенки даваат оценувачи \( \hat{\theta}_1, \hat{\theta}_2, \dots, \hat{\theta}_m \) за непознатите параметри.

---

### **Пример за имплементација на методот на моменти во R**

Еден ресторан сака да го одреди просечниот број на клиенти кои пристигнуваат во одреден час. За таа цел, биле собрани податоци за бројот на клиенти во 10 различни часови, и добиените податоци се следните:
3, 5, 4, 6, 2, 3, 4, 5, 7, 4.  

Претпоставете дека бројот на клиенти следи Пуасонова распределба со параметар \(\lambda\) (просечен број на клиенти во час).
Направете проценка на параметарот на Пуасоновата распределба со метод на моменти.

---

**Потсетник за Пуасоновата распределба:**

- Пуасоновата распределба има параметар \(\lambda\), кој претставува средната вредност (\(\mathbb{E}[X]\)) и варијансата (\(\text{Var}(X)\)).
- Методот на моменти го изедначува емпирискиот момент (\(\bar{X}\)) со теоретскиот момент (\(\mathbb{E}[X] = \lambda\)).

**Решение:**

1. Пресметај ја **средната вредност** на податоците (\(\bar{X}\)) како проценка за \(\lambda\):  
\[
\bar{X} = \frac{\text{Збир на сите набљудувања}}{\text{Број на набљудувања}}
\]

2. Изедначи го теоретскиот момент со емпирискиот момент за да го процениш \(\lambda\):
\[
\hat{\lambda} = \bar{X}
\]

```{r}
#X-број на клиенти по час
# Внесување на податоците за бројот на клиенти по час
x <- c(3, 5, 4, 6, 2, 3, 4, 5, 7, 4)

# Пресметка на средната вредност на податоците
# Средната вредност (mean) се користи како проценка за параметарот λ
mean_x <- mean(x)

# Поставување на проценетата вредност за параметарот λ според методот на моменти
# За Пуасоновата распределба, параметарот λ е еднаков на средната вредност
lambda_x <- mean_x

# Приказ на проценетата вредност за λ
print(lambda_x)
```

### **3. Параметарски тестови**

### Статистичка хипотеза

Секоја претпоставка за популацијата, за распределбата на некое нејзино обележје, за вредностите на некои параметри на обележјето и сл. се вика **статистичка хипотеза**.

Постапката со која врз основа на податоците од даден примерок се проверува точноста на поставената хипотеза се нарекува **статистички тест**.

------------------------------------------------------------------------

### Параметарски и непараметарски тестови

**Дефиниција:**\
Доколку видот (функционалниот облик) на функцијата $F(x, \theta)$ е познат, а непознати се параметрите и се претпоставени некои вредности за нив, велиме дека хипотезата е **параметарска хипотеза**.
Во секој друг случај, велиме дека хипотезата е **непараметарска**.

------------------------------------------------------------------------

### Нулта и алтернативна хипотеза

**Дефиниција:**\
Хипотезата која се тестира се нарекува **нулта хипотеза** и се означува со $H_0$, а спротивната хипотеза се нарекува **алтернативна хипотеза** и се означува со $H_a$.

### Проста хипотеза

Хипотезите во кои се појавува само една вредност на непознатиот параметар се нарекуваат **прости хипотези**.

**Пример:**\
$H_0: p = \frac{1}{2}$ е проста хипотеза, бидејќи претпоставува точна вредност за параметарот $p$.

------------------------------------------------------------------------

### Сложена хипотеза

Хипотезите со кои за параметарот се дозволени повеќе вредности се нарекуваат **сложени хипотези**.

**Пример:**
$H_0: p_1 \neq \frac{1}{2}$ е сложена хипотеза, затоа што тука за p се допуштени сите вредности од интервалот (0,1) кои се различни од ½.

------------------------------------------------------------------------

### Едностран и двостран тест

Доколку хипотезата е $H_0: p = \frac{1}{2}$\

-Доколку алтернативната хипотеза е: $H_а: p_1 \neq \frac{1}{2}$ станува збор за двостран тест.

-Доколку алтернативната хипотеза е: $H_a: p > \frac{1}{2} \text{ или } p < \frac{1}{2}$ тогаш станува збор за едностран тест.

### **Параметарски тестови**

Параметарските тестови се статистички тестови кои се користат за да се проверат одредени претпоставки за податоците, како што се:

- **Просекот (\( \mu \)):** средната вредност на податоците добиени од примерокот.
- **Стандардна девијација (\( \sigma^2 \)):** ширината или распределбата на податоците.

### **Тестови за едно обележје**

### Тестови за математичко очекување на обележје

Нека (X1,…,Xn) е случаен примерок за обележјето X чие математичко очекување е непознато. 

Ќе разгледаме тестови за математичко очекување на обележјето X, и тоа во два случаи:

-кога обележјето има нормална распределба и произволна големина на примерок.

-кога обележјето нема нормална распределба, но даден е голем случаен примерок од популацијата.

Нека нивото на значајност на тестот е α.

### Тестови за математичко очекување кај нормална распределба


**Еднострани и Двострани Тестови за Математичкото Очекување**

Ќе разгледаме еднострани и двострани тестови за математичкото очекување на обележјето $X$ кое има нормална распределба $N(\mu, \sigma^2)$ при неколку сценарија:

1. **Познато $\sigma^2$, произволна големина на примерок**

2. **Непознато $\sigma^2$**

   2.1 **Мал примерок**  
   2.2 **Голем примерок**
   
**Тест за математичко очекување на обележје \( X \sim N(\mu, \sigma^2) \), со позната дисперзија σ² и произволна големина на примерок**

Кога обележјето X има нормална распределба  \( X \sim N(\mu, \sigma^2) \) со позната дисперзија σ² и произволна големина на примерок за да направиме тест на математичкото очекување ја користиме следната функција во R:

```{r}
#library(BSDA)
#z.test(x = x, alt = "tip na alternativna hipoteza", conf.level = 1 - alpha, mu = mu, sigma.x = sigma_x)
#каде x е вектор кој ги содржи вредностите на обележјето X добиени од примерокот
#alt е типот на алтернативнта хипотеза Ha која може да биде: two.sided (двостран тест), left (едностран тест), right (едностран тест)
#alpha е нивото на значајност на тестот
#mu е математичкото очекување на обележјето од дадениот примерок додека sigma_x е позната стандардна девијација

```

### Пример 1

Познато е дека задоволството на клиентите во една продавница за електронски уреди, мерено на скала од 1 до 5, има нормална распределба со очекувана вредност \( \mu = 4.2 \) и стандардна девијација \( \sigma = 0.8 \).  
Научен тим од 50 клиенти направил анкета во продавницата и ги добил следните резултати:

\[
\begin{aligned}
4.25, & \quad 4.05, \quad 3.95, \quad 4.10, \quad 4.15, \\
4.20, & \quad 3.85, \quad 4.00, \quad 3.75, \quad 4.30, \\
3.90, & \quad 4.05, \quad 4.25, \quad 4.00, \quad 3.95, \\
4.10, & \quad 4.20, \quad 4.05, \quad 3.80, \quad 4.30, \\
4.10, & \quad 3.85, \quad 4.00, \quad 3.75, \quad 4.05, \\
4.20, & \quad 4.10, \quad 3.95, \quad 4.15, \quad 4.00, \\
3.80, & \quad 4.05, \quad 4.25, \quad 4.10, \quad 3.95, \\
3.85, & \quad 4.00, \quad 4.05, \quad 4.30, \quad 3.75, \\
3.95, & \quad 4.20, \quad 4.15, \quad 3.85, \quad 4.00, \\
4.25, & \quad 4.05, \quad 4.10, \quad 3.90
\end{aligned}
\]

Добиен е просечен резултат од \( \bar{x} = 4.0 \). На ниво на значајност \( \alpha = 0.01 \), дали може да се заклучи дека задоволството на клиентите во продавницата е пониско од просечната вредност \( 4.2 \)?

**Решение**

```{r}
#X-задоволство на клиенти во една продавница на електронски уреди
x <- c(4.25, 4.05, 3.95, 4.10, 4.15, 4.20, 3.85, 4.00, 3.75, 4.30, 
       3.90, 4.05, 4.25, 4.00, 3.95, 4.10, 4.20, 4.05, 3.80, 4.30, 
       4.10, 3.85, 4.00, 3.75, 4.05, 4.20, 4.10, 3.95, 4.15, 4.00, 
       3.80, 4.05, 4.25, 4.10, 3.95, 3.85, 4.00, 4.05, 4.30, 3.75, 
       3.95, 4.20, 4.15, 3.85, 4.00, 4.25, 4.05, 4.10, 3.90)
#Поставување на нултата и алтренативната хипотеза
#H0:μ=4.2
#Ha:μ<4.2
# Параметри
mu <- 4.2             # Математичко очекување
sigma_x <- 0.8        # Позната стандардна девијација
alpha <- 0.01         # Ниво на значајност

# Тест
library(BSDA)         # Пакет за z-тест
z_result_test=z.test(x = x, 
       alternative = "less", 
       mu = mu, 
       sigma.x = sigma_x, 
       conf.level = 1 - alpha)
print(z_result_test)
```
Вредноста на нивото на заначајност на тестот \( \alpha = 0.01 \) е помала од **p-вредност = 0.07916**, па затоа нултата хипотеза се прифаќа т.е. просечната вредност на задоволството на клиентите во една продавница за електронски уреди е 4.2.

**Тест за обележје \( X \sim N(\mu, \sigma^2) \), со непознато дисперзија σ² и мал примерок **

Доколку имаме обележје X кое има нормална распределба со непозната дисперзија и мал примерок се користи следната функција во R:
```{r}
#t.test(x,alt='tip na alternativna hipoteza',conf.level=1-alpha,mu=mu)
#каде x е вектор кој ги содржи вредностите на обележјето X добиени од примерокот
#alt е типот на алтернативнта хипотеза Ha која може да биде: two.sided (двостран тест), left (едностран тест), right (едностран тест) 
#alpha е нивото на значајност на тестот
#mu е математичкото очекување на случајната променлива.
```

### Пример 2

Познато е дека времето на доставување пакети во еден логистички центар има нормална распределба со очекувано време од 12 часа за испорака.  
Од група од 25 случајно избрани пакети се добиени следните резултати:

\[
\begin{aligned}
13.02, & \quad 12.75, \quad 14.10, \quad 12.45, \quad 13.20, \\
12.15, & \quad 11.85, \quad 13.45, \quad 12.80, \quad 11.95, \\
13.50, & \quad 12.55, \quad 12.90, \quad 12.30, \quad 13.00, \\
12.10, & \quad 11.65, \quad 13.35, \quad 12.60, \quad 12.50, \\
12.40, & \quad 13.10, \quad 11.95, \quad 12.85, \quad 12.25, \\
13.15, & \quad 12.05
\end{aligned}
\]

Средна вредност на примерокот е \( \bar{x} = 12.6 \) часа за испорака, со стандардна девијација од \( \sigma = 1.5 \) часа. На ниво на значајност \( \alpha = 0.05 \), дали може да се тврди дека времето на испорака е поголемо од предвиденото?

**Решение:**


```{r}
# Податоци
#X-време на доставување на пакети во еден логистички центар
x<-c(13.02, 12.75, 14.10, 12.45, 13.20, 12.15, 11.85, 13.45, 12.80, 11.95,
13.50, 12.55, 12.90, 12.30, 13.00, 12.10, 11.65, 13.35, 12.60, 12.50,
12.40, 13.10, 11.95, 12.85, 12.25, 13.15, 12.05)

#Поставување на нултата и алтренативната хипотеза

#H0:EX=12.6
#Ha:EX>12.6

# Параметри
mu <- 12.6           # Математичко очекување
alpha <- 0.05        # Ниво на значајност

# t-тест
t_test_result=t.test(x, 
       alternative = "greater", 
       mu = mu, 
       conf.level = 1 - alpha)
print(t_test_result)
```
Вредноста на нивото на заначајност на тестот \( \alpha = 0.05 \) е помала од **p-вредност = 0.2898**, па затоа нултата хипотеза се прифаќа т.е.  просечното време на доставување на пакети во еден логистички центар е еднакво на 12.6.

**Тест за математичко очекување на случајна променлива  \( X \sim N(\mu, \sigma^2) \), непозната дисперзија σ²и голем примерок**

Доколку имаме случајна променлива X која има нормална распределба и чија дисперзија е позната и мал примерок се користи следната функција во R:

```{r}
#z.test(x,alt="tip na alternativna hipoteza",conf.level=1-alpha,mu=M0,sigma_x=sd(vrednosti_na_slucajnata_promenliva))
#каде x е вектор кој ги содржи вредностите на обележјето X добиени од примерокот
#alt е типот на алтернативнта хипотеза Ha која може да биде: two.sided (двостран тест), left (едностран тест), right (едностран тест) 
#alpha е нивото на значајност на тестот
#mu е математичкото очекување на случајната променлива.
#poznata_standardna_devijacija е стандардната девијација на случајниот примерок
```

**Тест за еднаквост на дисперзии на две случајни променливи**

Доколку имаме случајни променливи X и Y се независни случајни променливи кои имаат нормална распределба и чија дисперзија е позната се користи следната функција во R:

```{r}
#var.test(x,y,alt='tip na alternativna hipoteza')
#каде x е вредностите на обележјето x од примерок,
#каде y е вредностите на обележјето y од примерокот,
#alt е типот на алтернативнта хипотеза Ha која може да биде: two.sided (двостран тест), left (едностран тест), right (едностран тест)
```

### Пример 3

Доколку еден професор спреведува ист тест по математика
во две училишта: Училиште A и Училиште Б и доколку добиените резултати од тестот за двете училишта се следни:

- **Училиште А:** 85, 78, 92, 88, 75, 83, 90, 79  
- **Училиште Б:** 80, 95, 89, 84, 76, 81, 85, 77  
Провери постои разлика помеѓу дисперзиите на резултатите 
помеѓу учениците во двете училишта со ниво на значајност \( \alpha = 0.05 \).
```{r}
#x-број на бодови од тестот добиени во училште A
x<-c(85, 78, 92, 88, 75, 83, 90, 79)
#y-број на бодови од тестот добиени од училиште Б
y<-c(80, 95, 89, 84, 76, 81, 85, 77)
#Поставување на нулта и алтернативна хипотеза
#H0:sigmax=sigmay
#Ha:sigmax!=sigmay
#alpha=0.05
var_test_result=var.test(x,y,alt='two.sided')
print(var_test_result)
```
Вредноста на нивото на заначајност на тестот \( \alpha = 0.05 \) е помала од **p-вредност = 0.9152**, па затоа нултата хипотеза се прифаќа стандардната девијација на обележјето X измерено врз примерокот е исто со стандардната девијација на обележјето Y.


**Тестирање на еднаквост на математички очекувања на две независни случајни променливи, дисперзиите се непознати и имаме мал или голем примерок**

Доколку имаме две обележја X и Y кои имаат нормална распределба и имаат непознати еднакви дисперзии без разлика на големината на примерокот и доколку сакаме да провериме дали математичките очекувања на овие две обележја се еднакви ја користиме следната функција во R:

```r
#t.test(x,y,alt='less',conf.level=1-alpha,var.equal = #TRUE)
#каде x е вредностите на обележјето x од примерок,
#каде y е вредностите на обележјето x од примерокот,
#alt е типот на алтернативнта хипотеза Ha која може да биде: two.sided (двостран тест), left (едностран тест), right (едностран тест)
#alpha е нивото на значајност на тестот
#var.equal го поставуваме на TRUE бидејќи дисперзиите на 
#двете обележја X и Y се еднакви
```
Доколку имаме две обележја X и Y кои имаат нормална распределба и имаат непознати различни дисперзии без разлика на големината на примерокот и сакаме да провериме дали математичките очекувања на двете обележја се еднакви ја користиме следната функција во R:

```r
#z.test(x,y,alt='two.sided',conf.level = 1-alpha,sigma.x=sd(x),sigma.y=sd(y))
#каде x е вредностите на обележјето x од примерок,
#каде y е вредностите на обележјето x од примерокот,
#alt е типот на алтернативнта хипотеза Ha која може да биде: two.sided (двостран тест), left (едностран тест), right (едностран тест)
#alpha е нивото на значајност на тестот
#var.equal го поставуваме на FALSE бидејќи дисперзиите на
#двете обележја X и Y не се еднакви
```
### Пример 4


Се спроведива биолошки експеримент во кој се испитува ефектот на два различни типа на ѓубриво врз растот на растенија од иста врста. Претпоставуваме дека висината на растенијата, изразена во сантиметри, е нормално распределена во двете групи и дека дисперзиите на висините се исти.

По примената на различните типови ѓубриво, добиени се следните податоци:

- За групата на растенија со ѓубриво А:
  \( n_1 = 20 \), \( \bar{X}_1 = 35.2 \) cm, \( S_1^2 = 9.5 \)

  Примерок:  
  \[
  34.8, 35.1, 35.6, 35.3, 36.2, 34.9, 35.0, 35.4, 34.7, 35.5,  
  36.1, 35.7, 34.6, 35.2, 35.9, 36.0, 35.8, 34.5, 35.3, 35.4
  \]

- За групата на растенија со ѓубриво Б:
  \( n_2 = 22 \), \( \bar{X}_2 = 33.8 \) cm, \( S_2^2 = 9.5 \)

  Примерок:  
  \[
  33.5, 33.7, 33.9, 34.0, 34.2, 33.4, 33.6, 33.8, 33.3, 33.9,  
  34.1, 33.2, 33.7, 33.6, 33.8, 34.0, 33.5, 33.4, 33.9, 33.7, 34.1, 33.8
  \]

Со ниво на значајност \( \alpha = 0.05 \), потребно е да се тестира дали постои разлика во математичките очекувања на висините на растенијата третирани со ѓубриво А и ѓубриво Б.




```{r}
#X-раст на растенија со типот на ѓубриво А
group_A <- c(34.8, 35.1, 35.6, 35.3, 36.2, 34.9, 35.0, 35.4, 34.7, 35.5, 
             36.1, 35.7, 34.6, 35.2, 35.9, 36.0, 35.8, 34.5, 35.3, 35.4)
#Y-раст на растенијата со типот на ѓубрето Б
group_B <- c(33.5, 33.7, 33.9, 34.0, 34.2, 33.4, 33.6, 33.8, 33.3, 33.9, 
             34.1, 33.2, 33.7, 33.6, 33.8, 34.0, 33.5, 33.4, 33.9, 33.7, 
             34.1, 33.8)
#H0:μ_A=μ_B
#Ha: μ_A!=μ_B
# t-тест
t_test_result <- t.test(group_A, group_B, var.equal = TRUE)

# Резултати
print(t_test_result)
```
Вредноста на нивото на заначајност на тестот \( \alpha = 0.05 \) е поголема од **p-вредност = 4.988e-16**, па затоа нултата хипотеза се отфрла т.е. алтернативната хипотеза Ha се прифаќа т.е. просекот на растот на растенијата од двата типа на ѓубрива не е еднаков. 


### **Дополнителни задачи**

**Задача 1: Анализа на цени на криптовалути со дескриптивни статистики**

Во оваа задача, ќе ги примените вашите знаења за дескриптивна статистика за да ги анализирате дневните податоци за цените на криптовалутите. Целта на задачата е да го процените распоредот на податоците, да идентификувате можни 'outliers', и да размислите за тоа кои статистички мерки најдобро ја претставуваат тенденцијата на податоците. Ова е од голема важност при анализа на финансиски податоци, особено кога се работи со нестабилни пазари како криптовалутите.

Имате податоци за дневни цени (во долари) на криптовалутата Биткоин за последните 15 дена:

1. Пресметајте ги следните дескриптивни статистики:
   - Средна вредност (просек)
   - Медијана
   - Интерквартално растојание (IQR)
   - Ранг
   - Стандардна девијација

2. Анализирајте ги резултатите:
   - Дали има значителна разлика меѓу средната вредност и медијаната? Што може да значи тоа?

3. Направете визуелизација:
   - Направете boxplot за да ги прикажете квантилите и надворешните вредноти (outliers).
   - Направете хистограм за да ја покажете распределбата на цените.

**Податоци за Биткоин за последните 15 дена изразени во долари**:
94500, 95120, 94800, 94950, 95230, 94680, 94750, 95000, 94900, 95350, 94780, 94850, 95100, 94920, 95030
```{r}
#Изврши го твојот код тука
bitcoin<-c(94500, 95120, 94800, 94950, 95230, 94680, 94750, 95000, 94900, 95350, 94780, 94850, 95100, 94920, 95030)
prosek<-mean(bitcoin)
medijana<-median(bitcoin)
iqr1<-IQR(bitcoin)
rang<-range(bitcoin)
stdev<-sd(bitcoin)
print(prosek)
print(medijana)
print(iqr1)
print(rang)
print(stdev)
boxplot(bitcoin, main = "Boxplot на цените на Биткоин", ylab = "Цена во долари")
hist(bitcoin, breaks = 10, main = "Хистограм на цените на Биткоин", 
     xlab = "Цена во долари", col = "lightblue", border = "black")
```

**Задача 2: Анализа на биолошки експеримент **

Во еден биолошки експеримент се испитува ефектот на две различни диети врз тежината на лабораториски глувци. Секој глушец добива една од двете диети за период од 4 недели, а потоа се мери неговата телесна тежина во грамови. Целта на експериментот е да се утврди дали постои разлика во просечната тежина на глувците кои биле хранети со Диета А и глувците кои биле хранети со Диета Б.

По завршувањето на експериментот, добиени се следните податоци:

- **Група 1 (Диета А):**
  - Број на глувци: \( n_1 = 18 \)
  - Просечна тежина: \( \bar{X}_1 = 42.3 \) g
  - Варијанса: \( S_1^2 = 2.8 \)
  - Телесна тежина на секој глушец:  
    42.1, 42.5, 42.2, 43.0, 42.8, 42.4, 42.0, 41.9, 42.6, 42.7,  
    42.3, 43.1, 42.9, 41.8, 42.2, 42.5, 42.4, 42.8

- **Група 2 (Диета Б):**
  - Број на глувци: \( n_2 = 20 \)
  - Просечна тежина: \( \bar{X}_2 = 41.6 \) g
  - Варијанса: \( S_2^2 = 2.8 \)
  - Телесна тежина на секој глушец:  
    41.5, 41.8, 41.9, 41.6, 41.7, 41.4, 41.9, 42.0, 41.8, 41.7,  
    41.6, 41.5, 41.7, 41.9, 42.1, 41.4, 41.5, 41.6, 41.8, 41.9

```{r}
#Изврши го твојот код тука
dieta_a<-c(42.1, 42.5, 42.2, 43.0, 42.8, 42.4, 42.0, 41.9, 42.6, 42.7,  
    42.3, 43.1, 42.9, 41.8, 42.2, 42.5, 42.4, 42.8)
dieta_b<-c(41.5, 41.8, 41.9, 41.6, 41.7, 41.4, 41.9, 42.0, 41.8, 41.7,  
    41.6, 41.5, 41.7, 41.9, 42.1, 41.4, 41.5, 41.6, 41.8, 41.9)
test_result <- t.test(dieta_a, dieta_b, var.equal = TRUE)

print(test_result)
```

